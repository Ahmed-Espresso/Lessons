/* ==================================================
   SMALL SCREENS (Up to 480px)
================================================== */
@media only screen and (max-width: 480px) {
    /* تحسينات المودال للشاشات الصغيرة جداً */
    .modal-backdrop {
        padding: 10px 5px 5px 5px;
        align-items: flex-start;
        justify-content: center;
        overflow: hidden;
    }
    
    .modal-content-new {
        width: 95% !important;
        max-width: 95% !important;
        height: 90vh !important;
        max-height: 90vh !important;
        min-height: 90vh !important;
        border-radius: 1rem;
        margin: 0;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        position: relative;
    }
    
    /* تأثير ظهور المودال في الجوال */
    .modal-backdrop.active .modal-content-new {
        transform: translateY(0) scale(1);
        opacity: 1;
    }
    
    /* إصلاح الهيدر */
    .modal-header {
        padding: 1rem !important;
        border-radius: 1rem 1rem 0 0;
        position: relative;
        top: 0;
        min-height: 60px;
        flex-shrink: 0;
        border-bottom: 2px solid var(--bg-text);
        background: var(--bg-card);
    }
    
    .modal-header h2 {
        font-size: 1.2rem !important;
        max-width: 70%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    /* إصلاح محتوى النموذج */
    .form-compact-new {
        padding: 1.2rem 1rem !important;
        min-height: calc(90vh - 160px) !important;
        max-height: calc(90vh - 160px) !important;
        overflow-y: auto !important;
        flex: 1 !important;
        -webkit-overflow-scrolling: touch;
        margin-bottom: 0;
        scrollbar-width: thin;
        /* مسافة أكبر للفوتر في الموبايل */
        padding-bottom: 20px !important;
    }
    
    /* إصلاح الفوتر */
    .form-actions {
        padding: 1rem !important;
        gap: 0.5rem !important;
        flex-wrap: nowrap;
        position: sticky !important;
        bottom: 0;
        margin-top: 10px !important; /* مسافة فوق الفوتر */
        background: var(--bg-card);
        border-top: 2px solid var(--bg-text);
        border-radius: 0 0 1rem 1rem !important;
        flex-shrink: 0;
        z-index: 10;
        min-height: 70px;
        box-sizing: border-box;
    }
    
    /* حالة زر واحد فقط */
    .form-actions:has(.grid-btn:only-child) {
        justify-content: center;
    }
    
    .form-actions:has(.grid-btn:only-child) .grid-btn {
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
        padding: 0.8rem !important;
    }
    
    /* حالتين للأزرار */
    .form-actions:has(.grid-btn:nth-child(2):last-child) {
        justify-content: space-between;
        gap: 0.5rem !important;
    }
    
    .form-actions:has(.grid-btn:nth-child(2):last-child) .grid-btn {
        flex: 0 0 calc(50% - 0.25rem) !important;
        max-width: calc(50% - 0.25rem) !important;
        padding: 0.7rem 0.5rem !important;
        font-size: 0.85rem !important;
        min-width: 0 !important;
    }
    
    /* ثلاث أزرار أو أكثر */
    .form-actions:has(.grid-btn:nth-child(3)) {
        gap: 0.4rem !important;
    }
    
    .form-actions:has(.grid-btn:nth-child(3)) .grid-btn {
        flex: 1 !important;
        min-width: calc(33.333% - 0.3rem) !important;
        padding: 0.6rem 0.4rem !important;
        font-size: 0.8rem !important;
        gap: 0.2rem !important;
    }
    
    /* إصلاح حقول الإدخال */
    .form-compact-new input,
    .form-compact-new select,
    .form-compact-new textarea,
    .admin-form input,
    .admin-form select,
    .admin-form textarea {
        padding: 0.7rem 0.8rem !important;
        font-size: 0.9rem !important;
        border-radius: 0.6rem !important;
        border-width: 1.5px !important;
    }
    
    /* إصلاح النصوص */
    .form-compact-new label,
    .admin-form label {
        font-size: 0.9rem !important;
        margin-bottom: 0.4rem !important;
    }
    
    /* إصلاح شبكة الأيقونات */
    .icon-grid {
        max-height: 130px !important;
        grid-template-columns: repeat(auto-fill, minmax(32px, 1fr)) !important;
        gap: 0.3rem !important;
        padding: 0.4rem !important;
    }
    
    .icon-option {
        width: 32px !important;
        height: 32px !important;
        font-size: 0.85rem !important;
    }
    
    /* إصلاح القوائم المنسدلة */
    .students-selector {
        max-height: 120px;
        overflow-y: auto;
    }
    
    /* إصلاح textarea */
    .form-compact-new textarea,
    .admin-form textarea {
        min-height: 100px !important;
    }
    
    /* تحسين التمرير */
    .modal-content-new {
        scrollbar-width: thin;
    }
    
    /* إصلاح الصفوف */
    .form-row {
        gap: 0.8rem !important;
        margin-bottom: 1.2rem !important;
    }
    
    .form-row .half {
        min-width: 100% !important;
        flex: 0 0 100% !important;
    }
    
    /* ==================== إصلاحات قسم رسالة الترحيب ==================== */
    .admin-form {
        padding: 0.5rem 0 !important;
    }
    
    .admin-form .form-group {
        margin-bottom: 1.2rem !important;
    }
    
    .admin-form .form-buttons {
        margin-top: 1.5rem !important;
        padding: 0 !important;
    }
    
    .admin-form .btn {
        width: 100% !important;
        max-width: 100% !important;
        padding: 0.8rem !important;
        font-size: 1rem !important;
    }

    .messages-filters select {
        background-position: left 0.8rem center;
        background-size: 10px;
        padding: 0.7rem 2rem 0.7rem 2.5rem;
    }
    
    .sender-avatar {
        width: 60px;
        height: 60px;
        font-size: 1.8rem;
    }
    
    .sender-name {
        font-size: 1.2rem;
    }
    
    .message-content-title {
        flex-direction: column;
        text-align: center;
        gap: 0.5rem;
    }
    
    .message-content-title h4 {
        font-size: 1.1rem;
    }
    
    .message-text-large {
        font-size: 0.95rem;
        line-height: 1.6;
        max-height: 200px;
    }

    .multi-select-grid {
        padding: 0.6rem !important;
        gap: 0.5rem !important;
        grid-template-columns: 1fr;
        max-height: 350px;
    }
    
    .select-option {
        padding: 0.6rem !important;
        gap: 0.6rem !important;
    }
    
    .select-option input[type="checkbox"] {
        width: 18px !important;
        height: 18px !important;
    }
    
    .select-option .option-text {
        font-size: 0.85rem !important;
    }

    .contact-section,
    .date-section,
    .status-section {
        padding: 0.8rem !important;
        margin-top: 0.8rem !important;
    }
    
    .contact-value {
        font-size: 0.9rem !important;
        padding: 0.4rem 0.6rem !important;
    }
    
    .contact-section .contact-value {
        font-size: 0.85rem !important;
    }
    
    .message-sender-info .sender-avatar {
        width: 50px !important;
        height: 50px !important;
        font-size: 1.5rem !important;
    }

    /* تبويبات المواد الدراسية */
    .subjects-tabs-wrapper {
        margin: 0 -1rem;
        padding: 0 1rem 1rem;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    .subjects-tabs-scroll {
        display: flex;
        gap: 0.5rem;
        padding-bottom: 0.5rem;
        min-width: max-content;
    }
    
    .subject-tab-btn {
        padding: 0.6rem 1rem;
        border: 2px solid var(--bg-text);
        background: transparent;
        color: var(--bg-text);
        border-radius: 0.75rem;
        font-size: 0.85rem;
        white-space: nowrap;
        flex-shrink: 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.3s ease;
    }
    
    .subject-tab-btn.active {
        background: var(--bg-text);
        color: var(--bg);
    }
    
    .subject-tab-btn i {
        font-size: 0.9rem;
    }
    
    /* رسالة عدم اختيار مادة */
    .content-placeholder {
        padding: 3rem 1.5rem;
        text-align: center;
        margin-top: 2rem;
    }
    
    .content-placeholder i {
        font-size: 3.5rem;
        margin-bottom: 1.5rem;
        opacity: 0.7;
    }
    
    .content-placeholder h3 {
        font-size: 1.3rem;
        margin-bottom: 0.8rem;
    }
    
    .content-placeholder p {
        font-size: 0.95rem;
        line-height: 1.5;
        opacity: 0.8;
    }
    
    /* تبويبات أنواع المحتوى */
    .content-type-tabs {
        display: flex;
        gap: 0.5rem;
        margin: 1.5rem 0;
        padding: 0.5rem;
        background: rgba(var(--bg-text-rgb), 0.05);
        border-radius: 0.75rem;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    .content-type-tab {
        padding: 0.6rem 1rem;
        border: 2px solid var(--bg-text);
        background: transparent;
        color: var(--bg-text);
        border-radius: 0.75rem;
        font-size: 0.85rem;
        white-space: nowrap;
        flex-shrink: 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.3s ease;
    }
    
    .content-type-tab.active {
        background: var(--bg-text);
        color: var(--bg);
    }
    
    .content-type-tab i {
        font-size: 0.9rem;
    }
    
    /* زر إضافة المحتوى */
    .add-content-btn-wrapper {
        margin: 1.5rem 0;
    }
    
    .add-content-btn {
        width: 100%;
        padding: 0.9rem;
        border: 2px solid var(--bg-text);
        background: var(--bg-text);
        color: var(--bg);
        border-radius: 0.75rem;
        font-size: 1rem;
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.8rem;
        transition: all 0.3s ease;
    }
    
    .add-content-btn:hover {
        opacity: 0.9;
        transform: translateY(-2px);
    }
    
    /* لوحات المحتوى */
    .content-tabs-container {
        margin-top: 1rem;
    }
    
    .content-tab-panel {
        display: none;
    }
    
    .content-tab-panel.active {
        display: block;
    }
    
    /* بطاقات المحتوى */
    .content-card {
        background: rgba(var(--bg-text-rgb), 0.05);
        border: 2px solid rgba(var(--bg-text-rgb), 0.2);
        border-radius: 0.75rem;
        padding: 1rem;
        transition: all 0.3s ease;
        cursor: pointer;
        position: relative;
        overflow: hidden;
    }
    
    .content-card:hover {
        border-color: var(--bg-text);
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .content-card-icon {
        width: 50px;
        height: 50px;
        background: rgba(var(--bg-text-rgb), 0.1);
        border-radius: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1rem;
    }
    
    .content-card-icon i {
        font-size: 1.5rem;
        color: var(--bg-text);
    }
    
    .content-card-title {
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--bg-text);
        text-align: center;
        margin-bottom: 0.5rem;
        line-height: 1.3;
    }
    
    .content-card-size {
        font-size: 0.8rem;
        color: var(--bg-text);
        opacity: 0.7;
        text-align: center;
    }
    
    .file-upload-label {
        padding: 0.8rem;
        flex-direction: column;
        text-align: center;
        gap: 0.5rem;
    }
    
    .file-upload-label i {
        font-size: 1.2rem;
    }
    
    .pdf-action-btn {
        width: 100% !important;
        max-width: 100% !important;
        padding: 0.8rem !important;
        font-size: 0.95rem !important;
        gap: 0.5rem !important;
        margin: 0 auto !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
    }
    
    .image-preview-modal .preview-image {
        max-height: 200px;
    }
    
    .audio-preview-modal,
    .pdf-preview-modal {
        padding: 1rem;
    }

    /* تحسين معاينة الصور */
    .image-preview-modal .preview-image {
        max-height: 180px !important;
    }
    
    /* تحسين مشغل الصوت */
    .audio-preview-modal .audio-player {
        height: 40px !important;
    }
    
    /* تحسين روابط الملفات */
    .file-link {
        word-break: break-all !important;
        display: block !important;
        text-align: center !important;
        padding: 0.5rem !important;
        font-size: 0.8rem !important;
    }

    /* ✅ منع خروج Cloudinary ID من الحاوية */
    .file-link-container {
        word-break: break-all !important;
        overflow-wrap: break-word !important;
    }
    
    .file-id {
        word-break: break-all !important;
        overflow-wrap: break-word !important;
        font-size: 0.75rem !important;
        padding: 0.4rem !important;
        margin-top: 0.5rem !important;
    }
    
    /* تحسين حقل رفع الملف في الموبايل */
    .file-upload-label {
        padding: 0.7rem !important;
    }

    /* ✅ تصغير أيقونة التحميل في الزر */
    .pdf-action-btn i {
        font-size: 0.9rem !important;
        margin: 0 !important;
    }
    
    /* ✅ أيقونة PDF الكبيرة في المعاينة - ضبط الحجم */
    .pdf-preview-modal i.fa-file-pdf {
        font-size: 2.5rem !important;
        color: var(--bg-text) !important; /* تتبع لون الثيم */
        margin-bottom: 0.8rem !important;
    }
    
    /* ✅ تصغير أيقونة حجم الملف */
    .file-id i,
    .pdf-preview-modal .fa-info-circle {
        font-size: 0.8rem !important;
        opacity: 0.7;
    }
    
    /* ✅ تصميم كروت المحتوى الجديدة للجوال */
    .content-card-new {
        height: 180px !important;
        min-height: 180px !important;
    }

    .content-card-header {
        padding: 0.4rem 0.6rem !important;
        min-height: 40px !important;
    }

    .content-badge-groups,
    .content-badge-cloudinary {
        width: 22px !important;
        height: 22px !important;
        font-size: 0.65rem !important;
    }

    .content-card-body {
        padding: 0.5rem 0.6rem 0.3rem !important;
    }

    .content-card-body .image-preview-container {
        height: 80px !important;
        margin-bottom: 0.5rem !important;
    }

    .content-card-body i {
        font-size: 1.8rem !important;
        margin-bottom: 0.5rem !important;
    }

    .content-card-footer {
        padding: 0.5rem 0.6rem !important;
        min-height: 45px !important;
    }

    .content-card-title {
        font-size: 0.85rem !important;
    }

    .content-card-size {
        font-size: 0.75rem !important;
    }

}

/* ==================================================
   MEDIUM SCREENS (481px - 768px)
================================================== */
@media only screen and (min-width: 481px) and (max-width: 768px) {
    /* تحسينات المودال للشاشات المتوسطة */
    .modal-backdrop {
        padding: 12px;
    }
    
    .modal-content-new {
        width: 92% !important;
        max-width: 92% !important;
        height: 88vh !important;
        max-height: 88vh !important;
        min-height: 88vh !important;
    }
    
    /* تحسين الهيدر */
    .modal-header {
        padding: 1.2rem 1.5rem !important;
        min-height: 65px;
    }
    
    .modal-header h2 {
        font-size: 1.5rem !important;
    }
    
    /* تحسين محتوى النموذج */
    .form-compact-new {
        padding: 1.8rem 1.5rem !important;
        min-height: calc(88vh - 150px) !important;
        max-height: calc(88vh - 150px) !important;
        /* مسافة للفوتر */
        padding-bottom: 110px !important;
    }
    
    /* تحسين الأزرار */
    .form-actions {
        padding: 1.2rem 1.5rem !important;
        gap: 0.8rem !important;
        min-height: 75px;
        /* مسافة فوق الفوتر */
        margin-top: 15px !important;
    }
    
    /* حالة زر واحد فقط */
    .form-actions:has(.grid-btn:only-child) .grid-btn {
        width: 100% !important;
        max-width: 400px !important;
        margin: 0 auto !important;
    }
    
    /* حالتين للأزرار */
    .form-actions:has(.grid-btn:nth-child(2):last-child) {
        justify-content: space-between !important;
    }
    
    .form-actions:has(.grid-btn:nth-child(2):last-child) .grid-btn {
        flex: 0 0 calc(50% - 0.4rem) !important;
        max-width: calc(50% - 0.4rem) !important;
        padding: 0.8rem 1rem !important;
        font-size: 0.9rem !important;
    }
    
    /* ثلاث أزرار أو أكثر */
    .form-actions:has(.grid-btn:nth-child(3)) .grid-btn {
        flex: 1 !important;
        min-width: calc(33.333% - 0.6rem) !important;
        padding: 0.7rem 0.8rem !important;
        font-size: 0.85rem !important;
    }
    
    /* تحسين حقول الإدخال */
    .form-compact-new input,
    .form-compact-new select,
    .form-compact-new textarea,
    .admin-form input,
    .admin-form select,
    .admin-form textarea {
        padding: 0.75rem 1rem !important;
        font-size: 0.95rem !important;
    }
    
    /* تحسين شبكة الأيقونات */
    .icon-grid {
        max-height: 160px !important;
        grid-template-columns: repeat(auto-fill, minmax(36px, 1fr)) !important;
        gap: 0.4rem !important;
    }
    
    .icon-option {
        width: 36px !important;
        height: 36px !important;
    }
    
    /* تحسين التمرير */
    .form-compact-new::-webkit-scrollbar {
        width: 8px !important;
    }
    
    /* ==================== إصلاحات قسم رسالة الترحيب ==================== */
    .admin-form {
        padding: 1rem 0 !important;
    }
    
    .admin-form .form-group {
        margin-bottom: 1.5rem !important;
    }
    
    .admin-form .form-buttons {
        margin-top: 2rem !important;
    }
    
    .admin-form .btn {
        width: 90% !important;
        max-width: 350px !important;
        padding: 0.9rem 1.5rem !important;
    }

    .messages-filters {
        grid-template-columns: 1fr;
        gap: 0.8rem;
        padding: 0.8rem;
    }
    
    .messages-filters select {
        padding: 0.8rem 1rem;
        font-size: 0.95rem;
    }
    
    .message-sender-info {
        flex-direction: column;
        text-align: center;
        padding: 1.2rem;
        gap: 1rem;
    }
    
    .sender-avatar {
        width: 70px;
        height: 70px;
        font-size: 2.2rem;
    }
    
    .sender-name {
        font-size: 1.3rem;
    }
    
    .message-meta-info {
        grid-template-columns: 1fr;
        gap: 0.8rem;
        padding: 1rem;
    }
    
    .meta-item {
        justify-content: space-between;
    }
    
    .message-content-container {
        padding: 1.2rem;
    }
    
    .message-text-large {
        padding: 1rem;
        font-size: 1rem;
        max-height: 250px;
    }

    .multi-select-grid {
        max-height: 450px;
        padding: 0.9rem;
    }

    .subjects-tabs-scroll {
        gap: 0.8rem;
    }
    
    .subject-tab-btn {
        padding: 0.8rem 1.5rem;
        font-size: 0.95rem;
    }
    
    .content-type-tabs {
        gap: 0.8rem;
        padding: 0.8rem;
    }
    
    .content-type-tab {
        padding: 0.8rem 1.5rem;
        font-size: 0.95rem;
    }
    
    .content-card {
        padding: 1.2rem;
    }
    
    .content-card-icon {
        width: 60px;
        height: 60px;
    }
    
    .content-card-icon i {
        font-size: 1.8rem;
    }
    
    .content-card-title {
        font-size: 1rem;
    }

    .content-card {
        padding: 1.2rem;
    }
    
    .image-preview-container {
        height: 110px;
    }
}

/* ==================================================
   تحسينات إضافية للوضع الأفقي على الجوال
================================================== */
@media only screen and (max-height: 500px) and (orientation: landscape) {
    .modal-backdrop {
        align-items: flex-start;
        padding: 5px;
    }
    
    .modal-content-new {
        height: 95vh !important;
        max-height: 95vh !important;
        width: 90% !important;
        border-radius: 1rem;
    }
    
    .form-actions {
        position: sticky !important;
        bottom: 0;
        margin-top: 10px !important;
    }
    
    .icon-grid {
        max-height: 90px !important;
    }
    
    .form-compact-new {
        min-height: calc(95vh - 140px) !important;
        max-height: calc(95vh - 140px) !important;
        padding-bottom: 100px !important;
    }
}

/* ==================================================
   تحسينات للشاشات الكبيرة جداً
================================================== */
@media only screen and (min-width: 1200px) {
    .modal-content-new {
        max-width: 700px;
    }
    
    .form-actions {
        justify-content: flex-end;
        margin-top: 25px;
    }
    
    .form-actions:has(.grid-btn:nth-child(2):last-child) .grid-btn {
        flex: 0 0 auto !important;
        width: auto !important;
        min-width: 150px !important;
    }
}

